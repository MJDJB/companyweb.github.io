<!DOCTYPE html>
<!-- ä¿®æ”¹ lang å±¬æ€§ç‚º en -->
<html lang="en">
<head>
    <meta charset="UTF - 8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.6.1/lunar.js"></script>
    <title>Tianji Metaphysics - BaZi & Cinnabar Energy Reading</title>
    <style>
        :root {
            --primary: #8B0000; /* ç¡ƒç ‚ç´… */
            --secondary: #DAA520; /* é‡‘è‰² */
            --bg: #FAF0E6; /* å®£ç´™è‰² */
            --text: #5C3317; /* å¢¨è‰² */
        }
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Microsoft JhengHei', 'æ¨™æ¥·é«”', serif;
        }
        body {
            background-color: var(--bg);
            color: var(--text);
            line-height: 2;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100" opacity="0.05"><text x="10" y="60" font-family="æ¨™æ¥·é«”" font-size="18">å¤©åœ°ç„é»ƒ å®‡å®™æ´ªè’</text></svg>');
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 253, 245, 0.9);
            padding: 30px;
            border: 1px solid var(--secondary);
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        .container:before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100" opacity="0.03"><path d="M20,20 L80,20 L80,80 L20,80 Z" stroke="%238B0000" stroke-width="1"/></svg>');
            pointer-events: none;
            z-index: 0;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px double var(--primary);
            position: relative;
        }
        .yin-yang {
            width: 70px;
            height: 70px;
            margin: 0 auto 15px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="49" fill="%23333" stroke="%23DAA520" stroke-width="1"/><path d="M50,0 a50,50 0 0 1 0,100 25,25 0 0 0 0,-50 25,25 0 0 1 0,-50" fill="%23fff"/><circle cx="50" cy="25" r="8" fill="%23333"/><circle cx="50" cy="75" r="8" fill="%23fff"/></svg>') no-repeat center;
        }
        h1 {
            color: var(--primary);
            font-size: 2.5rem;
            letter-spacing: 10px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            margin-bottom: 10px;
        }
        @keyframes glow {
            0% { box-shadow: 0 0 10px var(--primary); }
            50% { box-shadow: 0 0 30px var(--primary); }
            100% { box-shadow: 0 0 10px var(--primary); }
        }
        .form-container, .result-container {
            animation: glow 3s infinite;
        }
        .form-container {
            padding: 30px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 5px;
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
            border: 1px solid var(--secondary);
        }
        .form-group {
            margin-bottom: 25px;
        }
        label {
            display: block;
            margin-bottom: 10px;
            color: var(--primary);
            font-weight: bold;
            font-size: 1.1rem;
        }
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--secondary);
            border-radius: 4px;
            font-size: 1rem;
            background: rgba(255, 248, 240, 0.8);
        }
        button {
            background: linear-gradient(to bottom, var(--primary), #6B0000);
            color: white;
            border: none;
            padding: 15px;
            font-size: 1.1rem;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            transition: all 0.3s;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
            letter-spacing: 2px;
            font-family: 'æ¨™æ¥·é«”';
        }
        button:hover {
            background: linear-gradient(to bottom, #6B0000, var(--primary));
        }
        .result-container {
            display: none;
            padding: 30px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 5px;
            border: 1px solid var(--secondary);
            animation: fadeIn 0.8s;
            position: relative;
            margin-top: 20px;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .destiny-type {
            font-size: 1.8rem;
            color: var(--primary);
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            border-top: 1px dashed var(--secondary);
            border-bottom: 1px dashed var(--secondary);
            font-weight: bold;
        }
        .bazi-display {
            display: flex;
            justify-content: space-around;
            text-align: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        .bazi-pillar {
            font-size: 2.3rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 5px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .wuxing-title {
            text-align: center;
            font-size: 1.3rem;
            color: var(--primary);
            margin: 25px 0 15px;
            position: relative;
        }
        .wuxing-title:before, .wuxing-title:after {
            content: "âœ§";
            color: var(--secondary);
            margin: 0 15px;
        }
        .wuxing-bars {
            margin: 30px 0;
        }
        .wuxing-bar {
            height: 20px;
            background: #F0F0F0;
            border-radius: 10px;
            margin: 15px 0;
            position: relative;
            overflow: hidden;
            border: 1px solid #ddd;
        }
        .wuxing-fill {
            height: 100%;
            position: absolute;
            transition: width 1s ease-out;
            text-align: right;
            padding-right: 5px;
            font-size: 0.8rem;
            line-height: 20px;
            color: white;
        }
        .wood { background: #2E8B57; }
        .fire { background: #DC143C; }
        .earth { background: #DAA520; }
        .metal { background: #4682B4; }
        .water { background: #4169E1; }
        .analysis-content {
            margin: 25px 0;
            line-height: 2;
        }
        .cinnabar-card {
            border: 1px dashed var(--secondary);
            padding: 25px;
            margin-top: 40px;
            text-align: center;
            position: relative;
            background: rgba(255, 248, 240, 0.7);
        }
        .cinnabar-card:before {
            content: "å‰";
            position: absolute;
            top: 10px;
            right: 15px;
            color: var(--primary);
            opacity: 0.1;
            font-size: 6rem;
            z-index: 0;
            font-family: 'æ¨™æ¥·é«”';
        }
        .cinnabar-icon {
            font-size: 4rem;
            margin-bottom: 15px;
        }
        .cinnabar-name {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 10px;
            font-weight: bold;
        }
        .cinnabar-price {
            font-size: 1.5rem;
            color: var(--secondary);
            margin: 15px 0;
        }
        .cinnabar-benefits {
            text-align: left;
            margin: 20px 0;
            padding-left: 20px;
        }
        .cinnabar-benefits li {
            margin-bottom: 10px;
            position: relative;
            padding-left: 25px;
        }
        .cinnabar-benefits li:before {
            content: "âœ“";
            color: var(--secondary);
            position: absolute;
            left: 0;
            font-weight: bold;
        }
        .btn-buy {
            display: inline-block;
            padding: 12px 30px;
            background: var(--secondary);
            color: #333;
            text-decoration: none;
            border-radius: 30px;
            margin-top: 15px;
            font-weight: bold;
            transition: all 0.3s;
        }
        .btn-buy:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(218, 165, 32, 0.3);
        }
        @media (max-width: 600px) {
            h1 {
                font-size: 1.8rem;
                letter-spacing: 5px;
            }
            .bazi-pillar {
                font-size: 1.8rem;
            }
        }
        .challenge-options {
            display: grid;
            gap: 16px;
            grid-template-columns: 1fr 1fr;
            margin-top: 10px;
        }

        .option-card {
            border: 2px solid #ccc;
            border-radius: 8px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            gap: 12px;
            align-items: center;
            background: #fff;
        }

        .option-card .icon {
            font-size: 1.8em;
        }

        .option-card:hover {
            border-color: #d64c35;
            background: #fff5f1;
        }

        .option-card.selected {
            border-color: #d64c35;
            background: #fff0e9;
            box-shadow: 0 0 0 2px #d64c35 inset;
        }

        .option-card p {
            margin: 0;
            font-size: 0.9em;
            color: #555;
        }
    </style>
</head>
<body>

    <div class="container">
      <header>
        <div class="yin-yang"></div>
        <!-- Add Bagua Symbol -->
        <div class="bagua">
          <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 100 100">
            <!-- Simple Bagua Graphic -->
            <circle cx="50" cy="50" r="45" fill="#333" stroke="#DAA520" stroke-width="2" />
            <path d="M50,10 v30 M50,60 v30 M20,50 h30 M70,50 h30" stroke="#DAA520" stroke-width="4" />
          </svg>
        </div>
        <h1>Tianji Metaphysics</h1>
        <p>BaZi Destiny Reading Â· Elemental Balance Â· Empowering Cinnabar Charms</p>
      </header>
    
      <div class="form-container" id="form">
        <div class="metaphysics-intro">
          <p>
            BaZi (Eight Characters) is an ancient Chinese metaphysical system that reveals your life path through your
            birth date and time. It reflects how the Five Elements (Wood, Fire, Earth, Metal, Water) influence your destiny.
          </p>
        </div>
    
        <div class="form-group" id="first">
          <label for="birthday">Date of Birth</label>
          <input type="date" id="birthday" required inputmode="text" placeholder="Select a date" />
        </div>
    
        <div class="form-group" id="second">
          <label for="birthtime">Birth Time</label>
          <select id="birthtime" required inputmode="text">
            <option value="">Select a time</option>
            <option value="0">Zi Hour (11:00 PM â€“ 12:59 AM)</option>
            <option value="1">Chou Hour (1:00 AM â€“ 2:59 AM)</option>
            <option value="2">Yin Hour (3:00 AM â€“ 4:59 AM)</option>
            <option value="3">Mao Hour (5:00 AM â€“ 6:59 AM)</option>
            <option value="4">Chen Hour (7:00 AM â€“ 8:59 AM)</option>
            <option value="5">Si Hour (9:00 AM â€“ 10:59 AM)</option>
            <option value="6">Wu Hour (11:00 AM â€“ 12:59 PM)</option>
            <option value="7">Wei Hour (1:00 PM â€“ 2:59 PM)</option>
            <option value="8">Shen Hour (3:00 PM â€“ 4:59 PM)</option>
            <option value="9">You Hour (5:00 PM â€“ 6:59 PM)</option>
            <option value="10">Xu Hour (7:00 PM â€“ 8:59 PM)</option>
            <option value="11">Hai Hour (9:00 PM â€“ 10:59 PM)</option>
          </select>
        </div>
    
        <div class="form-group" id="third">
          <label for="gender">Gender</label>
          <select id="gender" required>
            <option value="">Select a gender</option>
            <option value="male">Male</option>
            <option value="female">Female</option>
          </select>
        </div>

        <div class="form-group" id="step" style="display: none">
            <label>Whatâ€™s your biggest challenge lately?</label>
            <div class="challenge-options" id="challenge-options">
            <div class="option-card" data-type="energy-booster">
                <div class="icon">ğŸ”‹</div>
                <div class="text">
                <strong>Tired and unmotivated</strong>
                <p>You often feel drained, foggy, and stuck.</p>
                </div>
            </div>
            <div class="option-card" data-type="calm-balancer">
                <div class="icon">ğŸŒŠ</div>
                <div class="text">
                <strong>Anxious or emotionally unstable</strong>
                <p>Your thoughts race and your heart never rests.</p>
                </div>
            </div>
            <div class="option-card" data-type="action-igniter">
                <div class="icon">ğŸ’­</div>
                <div class="text">
                <strong>Ideas but no action</strong>
                <p>You dream a lot but struggle to begin.</p>
                </div>
            </div>
            <div class="option-card" data-type="grounding-protector">
                <div class="icon">ğŸ”¥</div>
                <div class="text">
                <strong>Short-tempered or overwhelmed</strong>
                <p>You react quickly and burn out even faster.</p>
                </div>
            </div>
            </div>
        </div>
    
        <button id="calculateBtn">âœ¦ Begin My Reading âœ¦</button>
        <button id="nextBtn" style="display: none">âœ¦ Next âœ¦</button>
      </div>
      <div class="result-container" id="result">
        <div class="destiny-type" id="destiny-type">Your Energy Type</div>
    
        <div class="bazi-display">
          <div>
            <div class="bazi-pillar" id="year-pillar"></div>
            <div>Year Pillar (Ancestry)</div>
          </div>
          <div>
            <div class="bazi-pillar" id="month-pillar"></div>
            <div>Month Pillar (Parents)</div>
          </div>
          <div>
            <div class="bazi-pillar" id="day-pillar"></div>
            <div>Day Pillar (Self)</div>
          </div>
          <div>
            <div class="bazi-pillar" id="hour-pillar"></div>
            <div>Hour Pillar (Children)</div>
          </div>
        </div>
    
        <div class="wuxing-title">Your Five Element Energy Distribution</div>
        <div class="wuxing-bars">
          <div class="wuxing-bar">
            <div class="wuxing-fill wood" id="wood-bar" style="width: 0%">Wood</div>
          </div>
          <div class="wuxing-bar">
            <div class="wuxing-fill fire" id="fire-bar" style="width: 0%">Fire</div>
          </div>
          <div class="wuxing-bar">
            <div class="wuxing-fill earth" id="earth-bar" style="width: 0%">Earth</div>
          </div>
          <div class="wuxing-bar">
            <div class="wuxing-fill metal" id="metal-bar" style="width: 0%">Metal</div>
          </div>
          <div class="wuxing-bar">
            <div class="wuxing-fill water" id="water-bar" style="width: 0%">Water</div>
          </div>
        </div>
    
        <div class="analysis-content" id="fortune-analysis">
          <!-- Energy analysis will appear here -->
        </div>
    
        <div class="cinnabar-card">
          <div class="cinnabar-icon" id="cinnabar-icon">ğŸ”´</div>
          <h3 class="cinnabar-name" id="cinnabar-name">Recommended Cinnabar Talisman</h3>
          <p>Crafted based on your elemental profile</p>
          <div class="cinnabar-price" id="cinnabar-price">$27.00</div>
          <ul class="cinnabar-benefits" id="cinnabar-benefits">
            <!-- Product benefits will appear here -->
          </ul>
          <a href="#" class="btn-buy" id="buy-button">Order Now</a>
          <p style="margin-top: 15px; font-size: 0.9em;">Limited to 30 pieces</p>
        </div>
    
        <button id="returnBtn">âœ¦ Go Back âœ¦</button>
      </div>
    </div>
    
    <script>
        // ====== ä¸­åœ‹å‚³çµ±å‘½ç†æ•¸æ“šåº« ======
        const DESTINY_DATA = {
            // äº”è¡Œå°æ‡‰é—œä¿‚
            elements: {
                wood: { name: "æœ¨", color: "#2E8B57", score: 0 },
                fire: { name: "ç«", color: "#DC143C", score: 0 },
                earth: { name: "åœŸ", color: "#DAA520", score: 0 },
                metal: { name: "é‡‘", color: "#4682B4", score: 0 },
                water: { name: "æ°´", color: "#4169E1", score: 0 }
            },
            // å…«å­—ç¥ç…
            auspiciousSigns: {
                "å¤©ä¹™è²´äºº": "å±é›£æ™‚åˆ»æœ‰è²´äººç›¸åŠ©",
                "æ–‡æ˜Œè²´äºº": "è°æ˜éäººï¼Œå­¸æ¥­äº‹æ¥­æœ‰æˆ",
                "å¤ªæ¥µè²´äºº": "æ‚Ÿæ€§æ¥µé«˜ï¼Œé©åˆä¿®è¡Œåƒé“",
                "å¤©æœˆå¾·è²´äºº": "ä¸€ç”Ÿå°‘ç½å„ï¼Œé€¢å‡¶åŒ–å‰"
            },
            // å‘½ç†é¡å‹åˆ†æ
            destinyTypes: [
                {
                    name: "æœ¨ç«é€šæ˜æ ¼",
                    desc: "æ‚¨å‘½å¸¶æœ¨ç«ç›¸ç”Ÿä¹‹æ°£ï¼Œå…·æœ‰å‰µé€ åŠ›èˆ‡è¡Œå‹•åŠ›ï¼Œä½†éœ€æ³¨æ„æ°´ç«å¹³è¡¡",
                    weakElement: "water",
                    advice: "å¤šè¦ªè¿‘æ°´ç’°å¢ƒå¯èª¿å’Œå‘½ä¸­ç«æ°£"
                },
                {
                    name: "é‡‘ç™½æ°´æ¸…æ ¼",
                    desc: "é‡‘æ°´ç›¸ç”Ÿè³¦äºˆæ‚¨è°æ˜æ‰æ™ºï¼Œä½†éœ€è£œè¶³åœŸæ°£ä»¥ç©©å®šé‹å‹¢",
                    weakElement: "earth",
                    advice: "ä½©æˆ´é»ƒè‰²ç¡ƒç ‚å¯å¢å¼·åœŸè¡Œèƒ½é‡"
                },
                {
                    name: "åœŸåšé‡‘åŸ‹æ ¼",
                    desc: "ç©©é‡è¸å¯¦æ˜¯æ‚¨çš„å„ªå‹¢ï¼Œä½†éœ€æœ¨æ°£ç–åœŸä»¥é‡‹æ”¾æ½›èƒ½",
                    weakElement: "wood",
                    advice: "ç¶ è‰²æ¤ç‰©èˆ‡æœ¨è³ªæ“ºä»¶å¯æ¿€æ´»é‹å‹¢"
                },
                {
                    name: "æ°´ç«æ—¢æ¿Ÿæ ¼",
                    desc: "æ°´ç«å¹³è¡¡ï¼Œé‹å‹¢å¹³å’Œï¼Œéœ€ä¿æŒå„å…ƒç´ çš„å‡è¡¡"
                }
            ],
            types: [
                {
                    id: "energy-booster",
                    name: "Energy Booster",
                    trait: "Low Fire and Earth energy",
                    personality:
                    "Easily fatigued, mentally foggy, struggles with motivation and long-term planning.",
                    zodiac: "Emotionally driven like Water signs (Pisces, Cancer, Scorpio)",
                    explanation:
                    "Your birth energy shows a deficiency in Fire and Earth elements, which are responsible for drive, structure, and grounded action. You may often feel drained, indecisive, or stuck in your thoughts. Strengthening your inner fire is key to reigniting your passion and reclaiming direction.",
                    product: {
                    name: "Red Cinnabar Power Bracelet",
                    material: "Natural Red Cinnabar + Energized Red Agate Beads",
                    price: "$17.77",
                    benefits: [
                        "Revives inner energy flow within 7 days",
                        "Improves motivation and decision clarity",
                        "Traditionally worn by generals and Taoist priests for protection and courage",
                        "Red agate helps anchor thoughts into action",
                        "Cleansed & charged during full moon rituals"
                    ],
                    icon: "ğŸ”¥",
                    callToAction: "Activate Your Fire Energy",
                    badge: "Best for burnout, fatigue & emotional fog"
                    }
                },
                {
                    id: "calm-balancer",
                    name: "Calm Balancer",
                    trait: "Excess Water and Metal energy",
                    personality:
                    "Highly sensitive, anxious, prone to overthinking and insomnia. Emotionally reactive and easily overwhelmed.",
                    zodiac: "Like Air signs with emotional depth (Gemini, Libra, Aquarius)",
                    explanation:
                    "Your chart reveals overactive Water and Metal elements. This causes emotional turbulence, difficulty sleeping, and mental over-processing. You absorb energy from others too easily, and need grounding tools to stabilize your emotions.",
                    product: {
                    name: "Cinnabar & Obsidian Peace Pendant",
                    material: "Polished Black Obsidian + Red Cinnabar Core",
                    price: "$28.88",
                    benefits: [
                        "Shields your aura from negative emotional energy",
                        "Promotes inner peace and deeper sleep",
                        "Balances the heart-mind connection",
                        "Cinnabar calms nervous energy and overactivity",
                        "Obsidian clears absorbed emotional toxins"
                    ],
                    icon: "ğŸ’§",
                    callToAction: "Find My Inner Balance",
                    badge: "Best for anxiety, emotional empaths & deep sleepers"
                    }
                },
                {
                    id: "action-igniter",
                    name: "Action Igniter",
                    trait: "Strong Wood, deficient Fire",
                    personality:
                    "Creative thinker, full of ideas but lacks follow-through. Easily distracted, struggles with self-discipline.",
                    zodiac: "Like Fire signs in shadow (Leo, Aries, Sagittarius)",
                    explanation:
                    "You have strong generative (Wood) energy, but weak transformation (Fire) energy. This means you're constantly inspired, but rarely able to convert plans into results. Restoring your inner fire is crucial for execution and forward motion.",
                    product: {
                    name: "Cinnabar & Brass Focus Beads",
                    material: "Real Cinnabar, Antiqued Brass + Action Sigils",
                    price: "$32.22",
                    benefits: [
                        "Ignites your execution power and decisiveness",
                        "Channels mental energy into physical action",
                        "Worn by entrepreneurs for clarity and momentum",
                        "Brass amplifies solar (yang) fire intention",
                        "Cinnabar protects against mental self-sabotage"
                    ],
                    icon: "âš¡",
                    callToAction: "Boost My Action Energy",
                    badge: "Best for creatives, procrastinators & overthinkers"
                    }
                },
                {
                    id: "grounding-protector",
                    name: "Grounding Protector",
                    trait: "Excess Fire and Earth energy",
                    personality:
                    "Irritable, quick-tempered, often feels mentally overloaded or spiritually agitated. Tends to burn out quickly.",
                    zodiac: "Fiery and dominant like Aries, Taurus, or Capricorn",
                    explanation:
                    "You possess powerful Fire and Earth energy â€” but in excess, it can cause emotional volatility, short temper, and energetic blockages. You need purification and clarity to protect your spiritual space and calm inner heat.",
                    product: {
                    name: "White Quartz & Cinnabar Protection Ring",
                    material: "Polished White Quartz + Sacred Cinnabar Core",
                    price: "$27.00",
                    benefits: [
                        "Reduces irritability and restores mental calm",
                        "Blocks toxic emotional energies and overexertion",
                        "Enhances spiritual clarity and self-composure",
                        "White Quartz purifies fire overflows and mental static",
                        "Cinnabar provides grounding in high-pressure environments"
                    ],
                    icon: "ğŸŒ",
                    callToAction: "Restore My Inner Peace",
                    badge: "Best for overworked minds & emotional protection"
                    }
                }
            ],
            destinytypes: [
                {
                    name: "Energy Booster (Fire/Earth Deficient)",
                    desc: "Your energy analysis shows a lack of Fire/Earth elements. This causes low motivation and indecisiveness.",
                    product: {
                        id: "energy-bracelet",
                        name: "Red Cinnabar Bracelet",
                        price: "\$17.77",
                        icon: "ğŸ”¥",
                        benefits: [
                        "Boost vitality & confidence",
                        "Ancient Chinese energy talisman",
                        "Handcrafted with pure cinnabar"
                        ],
                        urgencyMsg: "23 people bought this today"
                    }
                },
                {
                    name: "Energy Booster (Fire/Earth Deficient)",
                    desc: "Your energy analysis shows a lack of Fire/Earth elements. This causes low motivation and indecisiveness.",
                    product: {
                        id: "energy-bracelet",
                        name: "Red Cinnabar Bracelet",
                        price: "\$17.77",
                        icon: "ğŸ”¥",
                        benefits: [
                        "Boost vitality & confidence",
                        "Ancient Chinese energy talisman",
                        "Handcrafted with pure cinnabar"
                        ],
                        urgencyMsg: "23 people bought this today"
                    }
                },
                {
                    name: "Energy Booster (Fire/Earth Deficient)",
                    desc: "Your energy analysis shows a lack of Fire/Earth elements. This causes low motivation and indecisiveness.",
                    product: {
                        id: "energy-bracelet",
                        name: "Red Cinnabar Bracelet",
                        price: "\$17.77",
                        icon: "ğŸ”¥",
                        benefits: [
                        "Boost vitality & confidence",
                        "Ancient Chinese energy talisman",
                        "Handcrafted with pure cinnabar"
                        ],
                        urgencyMsg: "23 people bought this today"
                    }
                },
                {
                    name: "Energy Booster (Fire/Earth Deficient)",
                    desc: "Your energy analysis shows a lack of Fire/Earth elements. This causes low motivation and indecisiveness.",
                    product: {
                        id: "energy-bracelet",
                        name: "Red Cinnabar Bracelet",
                        price: "\$17.77",
                        icon: "ğŸ”¥",
                        benefits: [
                        "Boost vitality & confidence",
                        "Ancient Chinese energy talisman",
                        "Handcrafted with pure cinnabar"
                        ],
                        urgencyMsg: "23 people bought this today"
                    }
                }
            ]
        };
        // ç²å–è¡¨å–®å…ƒç´ 
        const form = document.querySelector('.form-container form');
        const birthdayInput = document.getElementById('birthday');
        const birthtimeInput = document.getElementById('birthtime');
        const genderInput = document.getElementById('gender');
        const resultContainer = document.getElementById('result');
        const formContainer = document.getElementById('form');
        let selectedTypeId = null;
        let birthday = null;
        let gender = null;
        // è¨ˆç®—æŒ‰éˆ•é»æ“Šäº‹ä»¶
        // document.getElementById('calculateBtnB').addEventListener('click', () => {
        //     // ç°¡å–®é©—è­‰
        //     if (!birthdayInput.value || !birthtimeInput.value || !genderInput.value) {
        //         alert('è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«å­—æ®µ');
        //         return;
        //     }
        //     // æ¨¡æ“¬å‘½ç†è¨ˆç®—
        //     const randomType = DESTINY_DATA.destinyTypes[Math.floor(Math.random() * DESTINY_DATA.destinyTypes.length)];
        //     // é¡¯ç¤ºçµæœ
        //     document.getElementById('destiny-type').textContent = randomType.name;
        //     document.getElementById('fortune-analysis').textContent = randomType.desc;
        //     resultContainer.style.display = 'block';
        //     formContainer.style.display = 'none';
        // });
        // è¿”å›æŒ‰éˆ•é»æ“Šäº‹ä»¶
        document.getElementById('returnBtn').addEventListener('click', () => {
            resultContainer.style.display = 'none';
            formContainer.style.display = 'block';
            document.getElementById('first').style.display = 'block';
            document.getElementById('second').style.display = 'block';
            document.getElementById('third').style.display = 'block';
            document.getElementById('step').style.display = 'none';
            document.getElementById('calculateBtn').style.display = 'block';
            document.getElementById('nextBtn').style.display = 'none';
        });
        
        // åœ¨<script>æ ‡ç­¾å†…æ›¿æ¢ä¸ºä»¥ä¸‹ä»£ç 
        document.getElementById('calculateBtn').addEventListener('click', () => {
            birthday = new Date(document.getElementById('birthday').value);
            gender = document.getElementById('gender').value;
            
            if (!birthday || !gender) {
                alert('Please fill all fields');
                return;
            }
            document.getElementById('first').style.display = 'none';
            document.getElementById('second').style.display = 'none';
            document.getElementById('third').style.display = 'none';
            document.getElementById('step').style.display = 'block';
            document.getElementById('calculateBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'block';
        });

        document.querySelectorAll(".option-card").forEach(card => {
            card.addEventListener("click", () => {
            // æ¸…é™¤å·²æœ‰é€‰ä¸­çŠ¶æ€
            document.querySelectorAll(".option-card").forEach(c => c.classList.remove("selected"));
            // æ·»åŠ é€‰ä¸­çŠ¶æ€
            card.classList.add("selected");
            // ä¿å­˜é€‰ä¸­çš„ç±»å‹ID
            selectedTypeId = card.getAttribute("data-type");
            });
        });

        document.getElementById("nextBtn").addEventListener("click", () => {
            if (!selectedTypeId) {
            alert("Please select the option that best describes you.");
            return;
            }

            // const typeData = DESTINY_DATA.types.find(t => t.id === selectedTypeId);
            // if (typeData) {
            // showResult(typeData);
            // } else {
            // alert("An error occurred. Please refresh and try again.");
            // }
            // æ ¸å¿ƒè®¡ç®—é€»è¾‘
            const destinyType = calculateDestinyType(birthday, gender);
            showResult(destinyType);
        });

        // äº”è¡Œèƒ½é‡è®¡ç®—å‡½æ•°
        function calculateWood(year, month) {
            return (year % 12) * 8 + month * 3; // å¯…å¯æœˆæœ¨æ—º
        }

        function calculateFire(month, day) {
            return (month >= 4 && month <= 6) ? 80 + day : 30 + day; // å¤å­£ç«æ—º
        }

        function calculateEarth(year, day) {
            return (year % 10) * 5 + (day % 6) * 10; // å­£æœ«åœŸæ—º
        }

        function calculateMetal(year, month) {
            return (month >= 7 && month <= 9) ? 70 + (year % 5) * 6 : 40; // ç§‹å­£é‡‘æ—º
        }

        function calculateWater(month, day) {
            return (month >= 10 || month <= 1) ? 90 - day : 50 - (day % 4) * 5; // å†¬å­£æ°´æ—º
        }

        // å‘½ç†ç±»å‹åˆ¤å®šç®—æ³•
        function determineType(elements, gender) {
            const scores = {
                wood: elements.wood,
                fire: elements.fire,
                earth: elements.earth,
                metal: elements.metal,
                water: elements.water
            };

            // æ€§åˆ«å¾®è°ƒï¼ˆé˜³åˆš/é˜´æŸ”å±æ€§ï¼‰
            const genderModifier = gender === 'male' ? 1.2 : 0.8;
            scores.fire *= genderModifier;
            scores.water /= genderModifier;

            // ç±»å‹åˆ¤å®šè§„åˆ™
            if (scores.fire < 50 && scores.earth < 50) {
                return DESTINY_DATA.types[0]; // Energy Booster
            } else if (scores.metal > 70 && scores.water > 70) {
                return DESTINY_DATA.types[1]; // Calm Balancer
            } else if (scores.wood > 65 && scores.fire < 60) {
                return DESTINY_DATA.types[2]; // Action Igniter
            } else {
                return DESTINY_DATA.types[3]; // Grounding Protector
            }
        }

        // ç»“æœå±•ç¤ºå‡½æ•°// Enhanced result rendering function
        function showResult(type) {
            // åŸºæœ¬ä¿¡æ¯å±•ç¤º
            document.getElementById('destiny-type').textContent = type.name;

            // åˆ†æéƒ¨åˆ†æ„å»º
            document.getElementById('fortune-analysis').innerHTML = `
                <p><strong>ğŸ”® Type Explanation:</strong><br> ${type.explanation}</p>
                <p><strong>ğŸ§  Personality Traits:</strong> ${type.personality}</p>
                <p><strong>â™»ï¸ Elemental Insight:</strong> ${type.trait}</p>
                <p><strong>âœ¨ Compatible Zodiac:</strong> ${type.zodiac}</p>
            `;

            // äº§å“éƒ¨åˆ†æ„å»º
            const product = type.product;

            document.getElementById('cinnabar-icon').textContent = product.icon;
            document.getElementById('cinnabar-name').textContent = product.name;
            document.getElementById('cinnabar-price').textContent = product.price;

            // åŠ å…¥ badge æ ‡ç­¾ï¼ˆå¦‚â€œBest for anxietyâ€ç­‰ï¼‰
            const badgeHTML = product.badge
                ? `<div class="product-badge">â­ ${product.badge}</div>`
                : '';

            // å±•ç¤ºå¥½å¤„åˆ—è¡¨
            const benefitsList = product.benefits.map(
                (b) => `<li>ğŸ”¸ ${b}</li>`
            ).join('');

            document.getElementById('cinnabar-benefits').innerHTML = `
                ${badgeHTML}
                <ul class="benefit-list">${benefitsList}</ul>
            `;

            // CTA æŒ‰é’®æ–‡å­—æ›´æ–°
            const ctaButton = document.getElementById('cta-button');
            if (ctaButton) {
                ctaButton.textContent = product.callToAction || 'Learn More';
                ctaButton.style.display = 'inline-block';
            }

            // æ˜¾ç¤º/éšè—ç•Œé¢
            document.getElementById('result').style.display = 'block';
            document.getElementById('form').style.display = 'none';

            // å¯é€‰ï¼šæ»šåŠ¨åˆ°ç»“æœä½ç½®
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        }

        // function showResult(type) {
        //     document.getElementById('destiny-type').textContent = type.name;
        //     document.getElementById('fortune-analysis').innerHTML = `
        //         <p><strong>Personality:</strong> ${type.personality}</p>
        //         <p><strong>Compatible Zodiac:</strong> ${type.zodiac}</p>
        //         <p><strong>Elemental Insight:</strong> ${type.trait}</p>
        //     `;

        //     // æ›´æ–°äº§å“æ¨è
        //     const product = type.product;
        //     document.getElementById('cinnabar-icon').textContent = product.icon;
        //     document.getElementById('cinnabar-name').textContent = product.name;
        //     document.getElementById('cinnabar-price').textContent = product.price;
            
        //     const benefitsList = product.benefits.map(b => `<li>${b}</li>`).join('');
        //     document.getElementById('cinnabar-benefits').innerHTML = benefitsList;
            
        //     // æ˜¾ç¤ºç»“æœé¡µ
        //     document.getElementById('result').style.display = 'block';
        //     document.getElementById('form').style.display = 'none';
        // }
        function calculateDestinyType(birthDate, gender) {
            // 1. å°†ç”Ÿæ—¥è½¬æ¢ä¸ºå†œå†å¹´ä»½ï¼ˆç®€åŒ–ç‰ˆï¼‰
            let year = birthDate.getFullYear();
            let month = birthDate.getMonth() + 1;
            let day = birthDate.getDate();
            debugger;
            try {
                // const result = solarlunar.solar2lunar(year, month, day);
                const solar = Solar.fromYmd(year, month, day);
                const lunar = solar.getLunar();
                year = lunar.getYear(); // å†œå†å¹´ä»½
                month = lunar.getMonth(); // å†œå†æœˆä»½
                day = lunar.getDay; // å†œå†æ—¥æœŸ
            } catch (error) {
                alert('Invalid date format. Please try again.');
            }
            // 2. è®¡ç®—äº”è¡Œèƒ½é‡å€¼ï¼ˆ0-100ï¼‰
            const elements = {
                wood: calculateWood(year, month),
                fire: calculateFire(month, day),
                earth: calculateEarth(year, day),
                metal: calculateMetal(year, month),
                water: calculateWater(month, day)
            };
            const woodBar = document.getElementById('wood-bar');
            const waterBar = document.getElementById('water-bar');
            const metalBar = document.getElementById('metal-bar');
            const earthBar = document.getElementById('earth-bar');
            const fireBar = document.getElementById('fire-bar');
            woodBar.style.width = elements.wood + '%';
            waterBar.style.width = elements.water + '%';
            metalBar.style.width = elements.metal + '%';
            earthBar.style.width = elements.earth + '%';
            fireBar.style.width = elements.fire + '%';
            
            // 3. æ ¹æ®äº”è¡Œç›¸ç”Ÿç›¸å…‹ç¡®å®šå‘½ç†ç±»å‹
            return determineType(elements, gender);
        }
    </script>
</body>
</html>
